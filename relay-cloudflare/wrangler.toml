# Cloudflare Workers configuration for OpenClaw Chrome Bridge Relay
name = "openclaw-chrome-relay"
main = "src/index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# Environment variables (set via wrangler secret put)
# JWT_SECRET - for signing JWT tokens
# AGENT_SECRET - optional legacy shared agent secret (use per-agent secrets by default)
# ALLOW_LEGACY_GLOBAL_AGENT_SECRET - set true only during migration
# STRIPE_SECRET_KEY - Stripe API secret key
# STRIPE_PRICE_ID - Stripe recurring price ID for Pro plan
# STRIPE_WEBHOOK_SECRET - Stripe webhook signing secret
# BILLING_SUCCESS_URL - Redirect after successful checkout
# BILLING_CANCEL_URL - Redirect after cancelled checkout
# BILLING_PORTAL_RETURN_URL - Redirect after leaving billing portal

# D1 Database
[[d1_databases]]
binding = "DB"
database_name = "openclaw-relay"
database_id = "df61b083-8943-4f58-9b27-74d3ff6b55b3"

# Durable Objects
[durable_objects]
bindings = [
  { name = "AGENT_CONNECTION", class_name = "AgentConnection" },
  { name = "CLIENT_CONNECTION", class_name = "ClientConnection" },
  { name = "MESSAGE_ROUTER", class_name = "MessageRouter" }
]

[[migrations]]
tag = "v1"
new_sqlite_classes = ["AgentConnection", "ClientConnection", "MessageRouter"]

# Development settings
[env.development]
[[env.development.d1_databases]]
binding = "DB"
database_name = "openclaw-relay-dev"
database_id = "your-dev-d1-database-id"